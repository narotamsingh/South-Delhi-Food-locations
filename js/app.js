window.onerror=function(e){console.log(e)};var filter=function(e,n){this.name=e,this.value=n};function initViewModel(e){ListViewModel=ko.applyBindings(new ListViewModel(e))}var map,ListViewModel=function(e){var n=this;n.venues=e,n.locations=ko.observableArray(),n.currentFilter=ko.observable(),n.filters=ko.observableArray([new filter("All","All"),new filter("Indian","Indian Restaurant"),new filter("Asian","Asian Restaurant"),new filter("Café","Café"),new filter("Diner","Diner"),new filter("Japanese","Japanese Restaurant"),new filter("French","French Restaurant"),new filter("Mexican","Mexican Restaurant"),new filter("Coffee","Coffee Shop"),new filter("Italian","Italian Restaurant"),new filter("Tea","Tea Room")]),n.filterLocations=ko.computed(function(){return n.currentFilter()?"All"===n.currentFilter().name?(console.log("All List"),deleteMarkers(),createMarkers(n.venues),n.locations(n.venues)):(console.log("List has been filtered to: "+n.currentFilter().value),deleteMarkers(),createMarkers(ko.utils.arrayFilter(n.venues,function(e){if(e.categories[0].name===n.currentFilter().value)return!0})),n.locations(ko.utils.arrayFilter(n.venues,function(e){if(e.categories[0].name===n.currentFilter().value)return!0}))):(console.log("All List"),deleteMarkers(),createMarkers(n.venues),n.locations(n.venues))})};function listItemClick(e){for(var n in markers)markers[n].setAnimation(null);for(n in infoWindows)infoWindows[n].close();var r;for(n in markers)e.name===markers[n].title&&(markers[n].setAnimation(google.maps.Animation.BOUNCE),r=markers[n]);var t=e.name,a=e.contact.formattedPhone,i=e.location.formattedAddress,o=e.stats.checkinsCount,s=e.url;a||(a="---"),i||(i="---");var l=new google.maps.InfoWindow({content:"<b>Name:</b> "+t+"<br><b>Phone:</b> "+a+"<br><b>Address:</b> "+i+"<br><b>Checkins:</b> "+o+"<br><a href='"+s+"' title='Web Site'>Visit Web Site</a>"});infoWindows.push(l),l.open(map,r)}var markers=[],infoWindows=[];function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:28.592181,lng:77.219193},zoom:15,disableDefaultUI:!0})}function createMarkers(e){for(var n in e){var r=new google.maps.Marker({position:{lat:e[n].location.lat,lng:e[n].location.lng},map:map,animation:google.maps.Animation.DROP,title:e[n].name});attachInfo(r,e[n]),markers.push(r)}}function setMapOnAll(e){for(var n in markers)markers[n].setMap(e)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),markers=[]}function attachInfo(e,n){var r=n.name,t=n.contact.formattedPhone,a=n.location.formattedAddress,i=n.stats.checkinsCount,o=n.url;t||(t="---"),a||(a="---"),o||(o="---");var s=new google.maps.InfoWindow({content:"<b>Name:</b> "+r+"<br><b>Phone:</b> "+t+"<br><b>Address:</b> "+a+"<br><b>Checkins:</b> "+i+"<br><a href='"+o+"' title='Web Site'>Visit Web Site</a>"});infoWindows.push(s),e.addListener("click",function(){for(var n in markers)markers[n].setAnimation(null);for(n in infoWindows)infoWindows[n].close();s.open(map,e),e.setAnimation(google.maps.Animation.BOUNCE)})}
